function data = plotHeatmap(x,data,clims)
% PLOTHEATMAP - Plot heatmap with rows sorted by certain columns.
%
% Inputs:
%   data - the data of matrix. The range of data:[0 1].
%   sorted_by - Columns that used for row sorting. 
%   sort_idx -  Sort index can be given by this input.
%
% Outputs:
%   data - Sorted data.
%   idx - Sort index that are used.
%
% Example:
%   [~,s] = plotHeatmap(data1,41:61,[]);
%   plotHeatmap(data2,~,s);
%
% Other m-files required: none.
% Subfunctions: none.
% MAT-files required: none.
%
% See also: HIST_PLOT(), SCATTER_PLOT().

% Jingfeng Zhou, NIBS, jngfngzh@gmail.com
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Log:
% 06/03/2013: Complete
% 29/07/2014: Modified by Jingfeng Zhou
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%make sure that 0 and 1 are included in the data set
data_length = size(data,2);

if isnan(clims)
    imagesc(data);
elseif isempty(clims)
    imagesc(data);
else
    imagesc(data,clims);
end
% mycmap =     [0.208100005984306 0.166299998760223 0.52920001745224;0.208100005984306 0.190400004386902 0.578495264053345;0.208100005984306 0.214499995112419 0.627790451049805;0.208100005984306 0.238600000739098 0.677085697650909;0.195904761552811 0.264457136392593 0.72790002822876;0.17072856426239 0.291938096284866 0.779247641563416;0.125271424651146 0.324242860078812 0.830271422863007;0.0591333322227001 0.359833329916 0.868333339691162;0.0116952378302813 0.387509524822235 0.881957113742828;0.0059571429155767 0.408614277839661 0.882842838764191;0.0165142863988876 0.426600009202957 0.878633320331573;0.0269865076988935 0.442170649766922 0.870724558830261;0.0374587289988995 0.457741290330887 0.862815856933594;0.0479309521615505 0.473311901092529 0.854907155036926;0.0584031753242016 0.488882541656494 0.846998393535614;0.0688753947615623 0.504453182220459 0.839089632034302;0.0793476179242134 0.520023822784424 0.831180930137634;0.0749428570270538 0.537542879581451 0.826271414756775;0.0614095255732536 0.557222247123718 0.824131727218628;0.0478761903941631 0.57690155506134 0.821992039680481;0.0343428589403629 0.596580922603607 0.819852352142334;0.0264999996870756 0.613699972629547 0.813499987125397;0.0265404768288136 0.626323819160461 0.800304770469666;0.0265809521079063 0.638947606086731 0.78710949420929;0.0266214273869991 0.651571393013 0.773914277553558;0.0266619045287371 0.664195239543915 0.760719060897827;0.0383714288473129 0.674271404743195 0.743552386760712;0.09986562281847 0.690757870674133 0.700256764888763;0.161359816789627 0.707244396209717 0.65696108341217;0.222854003310204 0.723730862140656 0.613665461540222;0.28434818983078 0.740217328071594 0.570369780063629;0.345842391252518 0.756703794002533 0.527074158191681;0.407336592674255 0.773190319538116 0.483778476715088;0.468830764293671 0.789676785469055 0.44048285484314;0.530324995517731 0.806163251399994 0.397187203168869;0.591819167137146 0.822649717330933 0.353891551494598;0.653313338756561 0.839136242866516 0.310595899820328;0.714807569980621 0.855622708797455 0.267300248146057;0.776301741600037 0.872109174728394 0.224004596471787;0.837795913219452 0.888595640659332 0.180708944797516;0.899290144443512 0.905082166194916 0.137413293123245;0.960784316062927 0.921568632125854 0.0941176488995552;0.960784316062927 0.921568632125854 0.0941176488995552;0.960784316062927 0.921568632125854 0.0941176488995552;0.962962985038757 0.871459722518921 0.093246191740036;0.965141594409943 0.821350753307343 0.0923747271299362;0.967320263385773 0.771241843700409 0.091503269970417;0.969498932361603 0.721132874488831 0.0906318128108978;0.971677541732788 0.671023964881897 0.089760348200798;0.973856210708618 0.620915055274963 0.0888888910412788;0.976034879684448 0.570806086063385 0.0880174338817596;0.978213489055634 0.520697176456451 0.0871459692716599;0.980392158031464 0.470588237047195 0.0862745121121407;0.982174694538116 0.442067742347717 0.0855614989995956;0.983957231044769 0.413547247648239 0.0848484858870506;0.985739767551422 0.385026752948761 0.0841354727745056;0.987522304058075 0.35650622844696 0.0834224596619606;0.989304840564728 0.327985733747482 0.0827094465494156;0.991087317466736 0.299465239048004 0.0819964408874512;0.992869853973389 0.270944744348526 0.0812834277749062;0.994652390480042 0.242424249649048 0.0805704146623611;0.996434926986694 0.21390375494957 0.0798574015498161;0.998217463493347 0.18538324534893 0.0791443884372711;1 0.156862750649452 0.0784313753247261];
mycmap = [0.208100000000000,0.166300000000000,0.529200000000000;0.211623809523810,0.189780952380952,0.577676190476191;0.212252380952381,0.213771428571429,0.626971428571429;0.208100000000000,0.238600000000000,0.677085714285714;0.195904761904762,0.264457142857143,0.727900000000000;0.170728571428571,0.291938095238095,0.779247619047619;0.125271428571429,0.324242857142857,0.830271428571429;0.0591333333333334,0.359833333333333,0.868333333333333;0.0116952380952381,0.387509523809524,0.881957142857143;0.00595714285714286,0.408614285714286,0.882842857142857;0.0165142857142857,0.426600000000000,0.878633333333333;0.0328523809523810,0.443042857142857,0.871957142857143;0.0498142857142857,0.458571428571429,0.864057142857143;0.0629333333333333,0.473690476190476,0.855438095238095;0.0722666666666667,0.488666666666667,0.846700000000000;0.0779428571428572,0.503985714285714,0.838371428571429;0.0793476190476190,0.520023809523810,0.831180952380952;0.0749428571428571,0.537542857142857,0.826271428571429;0.0640571428571428,0.556985714285714,0.823957142857143;0.0487714285714286,0.577223809523810,0.822828571428572;0.0343428571428572,0.596580952380952,0.819852380952381;0.0265000000000000,0.613700000000000,0.813500000000000;0.0238904761904762,0.628661904761905,0.803761904761905;0.0230904761904762,0.641785714285714,0.791266666666667;0.0227714285714286,0.653485714285714,0.776757142857143;0.0266619047619048,0.664195238095238,0.760719047619048;0.0383714285714286,0.674271428571429,0.743552380952381;0.0589714285714286,0.683757142857143,0.725385714285714;0.0843000000000000,0.692833333333333,0.706166666666667;0.113295238095238,0.701500000000000,0.685857142857143;0.145271428571429,0.709757142857143,0.664628571428572;0.180133333333333,0.717657142857143,0.642433333333333;0.217828571428571,0.725042857142857,0.619261904761905;0.258642857142857,0.731714285714286,0.595428571428571;0.302171428571429,0.737604761904762,0.571185714285714;0.348166666666667,0.742433333333333,0.547266666666667;0.395257142857143,0.745900000000000,0.524442857142857;0.442009523809524,0.748080952380952,0.503314285714286;0.487123809523809,0.749061904761905,0.483976190476191;0.530028571428571,0.749114285714286,0.466114285714286;0.570857142857143,0.748519047619048,0.449390476190476;0.609852380952381,0.747314285714286,0.433685714285714;0.647300000000000,0.745600000000000,0.418800000000000;0.683419047619048,0.743476190476191,0.404433333333333;0.718409523809524,0.741133333333333,0.390476190476190;0.752485714285714,0.738400000000000,0.376814285714286;0.785842857142857,0.735566666666667,0.363271428571429;0.818504761904762,0.732733333333333,0.349790476190476;0.850657142857143,0.729900000000000,0.336028571428571;0.882433333333333,0.727433333333333,0.321700000000000;0.913933333333333,0.725785714285714,0.306276190476191;0.944957142857143,0.726114285714286,0.288642857142857;0.973895238095238,0.731395238095238,0.266647619047619;0.993771428571429,0.745457142857143,0.240347619047619;0.999042857142857,0.765314285714286,0.216414285714286;0.995533333333333,0.786057142857143,0.196652380952381;0.988000000000000,0.806600000000000,0.179366666666667;0.978857142857143,0.827142857142857,0.163314285714286;0.969700000000000,0.848138095238095,0.147452380952381;0.962585714285714,0.870514285714286,0.130900000000000;0.958871428571429,0.894900000000000,0.113242857142857;0.959823809523810,0.921833333333333,0.0948380952380953;0.966100000000000,0.951442857142857,0.0755333333333333;0.976300000000000,0.983100000000000,0.0538000000000000];
%mycmap = [0,0,1;0,0,0.749019622802734;0,0,0.498039215803146;0,0,0.374509811401367;0,0,0.250980406999588;0,0,0.188235312700272;0,0,0.125490203499794;0,0,0.107563033699989;0,0,0.0896358564496040;0,0,0.0717086866497993;0,0,0.0537815168499947;0,0,0.0358543433248997;0,0,0.0179271716624498;0,0,0;0.0156862754374743,0.0156862754374743,0;0.0313725508749485,0.0313725508749485,0;0.0470588281750679,0.0470588281750679,0;0.0627451017498970,0.0627451017498970,0;0.0784313753247261,0.0784313753247261,0;0.0941176563501358,0.0941176563501358,0;0.109803929924965,0.109803929924965,0;0.125490203499794,0.125490203499794,0;0.198366016149521,0.198366016149521,0;0.271241843700409,0.271241843700409,0;0.344117641448975,0.344117641448975,0;0.416993468999863,0.416993468999863,0;0.489869296550751,0.489869296550751,0;0.562745094299316,0.562745094299316,0;0.635620892047882,0.635620892047882,0;0.708496749401093,0.708496749401093,0;0.781372547149658,0.781372547149658,0;0.854248344898224,0.854248344898224,0;0.927124202251434,0.927124202251434,0;1,1,0;1,0.937500000000000,0;1,0.875000000000000,0;1,0.812500000000000,0;1,0.750000000000000,0;1,0.687500000000000,0;1,0.625000000000000,0;1,0.562500000000000,0;1,0.500000000000000,0;1,0.437500000000000,0;1,0.375000000000000,0;1,0.312500000000000,0;1,0.250000000000000,0;1,0.187500000000000,0;1,0.125000000000000,0;1,0.0625000000000000,0;1,0,0;0.964285731315613,0,0;0.928571403026581,0,0;0.892857134342194,0,0;0.857142865657806,0,0;0.821428596973419,0,0;0.785714268684387,0,0;0.750000000000000,0,0;0.714285731315613,0,0;0.678571403026581,0,0;0.642857134342194,0,0;0.607142865657806,0,0;0.571428596973419,0,0;0.535714268684387,0,0;0.500000000000000,0,0];
% mycmap = importdata('F:\Matlab\PSTHDraw\MyColormaps.mat');
set(gcf,'Colormap',mycmap)
axis xy;
xlim([0.5 data_length + 0.5]);
set(gca,'LineWidth',3,'FontSize',20,'TickDir','out','xTick',[],'yTick',[1 size(data,1)]);
% xlabel('Time (s)','FontSize',25,'FontWeight','Bold');
ylabel('Trial #','FontSize',25,'FontWeight','Bold');





