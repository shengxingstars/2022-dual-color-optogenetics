function data = plotHeatmap(times,data,clims)
% PLOTHEATMAP - Plot heatmap with rows sorted by certain columns.

%make sure that 0 and 1 are included in the data set
s = size(data);
data_length = s(2);

if clims == 0
    imagesc(data)
elseif isempty(clims)
    imagesc(data)
else
    imagesc(data,clims);
end
% mycmap = importdata('D:\LLH\PSTHDraw\MyColormaps.mat');
% mycmap = [0.208100000000000,0.166300000000000,0.529200000000000;0.211623809523810,0.189780952380952,0.577676190476191;0.212252380952381,0.213771428571429,0.626971428571429;0.208100000000000,0.238600000000000,0.677085714285714;0.195904761904762,0.264457142857143,0.727900000000000;0.170728571428571,0.291938095238095,0.779247619047619;0.125271428571429,0.324242857142857,0.830271428571429;0.0591333333333334,0.359833333333333,0.868333333333333;0.0116952380952381,0.387509523809524,0.881957142857143;0.00595714285714286,0.408614285714286,0.882842857142857;0.0165142857142857,0.426600000000000,0.878633333333333;0.0328523809523810,0.443042857142857,0.871957142857143;0.0498142857142857,0.458571428571429,0.864057142857143;0.0629333333333333,0.473690476190476,0.855438095238095;0.0722666666666667,0.488666666666667,0.846700000000000;0.0779428571428572,0.503985714285714,0.838371428571429;0.0793476190476190,0.520023809523810,0.831180952380952;0.0749428571428571,0.537542857142857,0.826271428571429;0.0640571428571428,0.556985714285714,0.823957142857143;0.0487714285714286,0.577223809523810,0.822828571428572;0.0343428571428572,0.596580952380952,0.819852380952381;0.0265000000000000,0.613700000000000,0.813500000000000;0.0238904761904762,0.628661904761905,0.803761904761905;0.0230904761904762,0.641785714285714,0.791266666666667;0.0227714285714286,0.653485714285714,0.776757142857143;0.0266619047619048,0.664195238095238,0.760719047619048;0.0383714285714286,0.674271428571429,0.743552380952381;0.0589714285714286,0.683757142857143,0.725385714285714;0.0843000000000000,0.692833333333333,0.706166666666667;0.113295238095238,0.701500000000000,0.685857142857143;0.145271428571429,0.709757142857143,0.664628571428572;0.180133333333333,0.717657142857143,0.642433333333333;0.217828571428571,0.725042857142857,0.619261904761905;0.258642857142857,0.731714285714286,0.595428571428571;0.302171428571429,0.737604761904762,0.571185714285714;0.348166666666667,0.742433333333333,0.547266666666667;0.395257142857143,0.745900000000000,0.524442857142857;0.442009523809524,0.748080952380952,0.503314285714286;0.487123809523809,0.749061904761905,0.483976190476191;0.530028571428571,0.749114285714286,0.466114285714286;0.570857142857143,0.748519047619048,0.449390476190476;0.609852380952381,0.747314285714286,0.433685714285714;0.647300000000000,0.745600000000000,0.418800000000000;0.683419047619048,0.743476190476191,0.404433333333333;0.718409523809524,0.741133333333333,0.390476190476190;0.752485714285714,0.738400000000000,0.376814285714286;0.785842857142857,0.735566666666667,0.363271428571429;0.818504761904762,0.732733333333333,0.349790476190476;0.850657142857143,0.729900000000000,0.336028571428571;0.882433333333333,0.727433333333333,0.321700000000000;0.913933333333333,0.725785714285714,0.306276190476191;0.944957142857143,0.726114285714286,0.288642857142857;0.973895238095238,0.731395238095238,0.266647619047619;0.993771428571429,0.745457142857143,0.240347619047619;0.999042857142857,0.765314285714286,0.216414285714286;0.995533333333333,0.786057142857143,0.196652380952381;0.988000000000000,0.806600000000000,0.179366666666667;0.978857142857143,0.827142857142857,0.163314285714286;0.969700000000000,0.848138095238095,0.147452380952381;0.962585714285714,0.870514285714286,0.130900000000000;0.958871428571429,0.894900000000000,0.113242857142857;0.959823809523810,0.921833333333333,0.0948380952380953;0.966100000000000,0.951442857142857,0.0755333333333333;0.976300000000000,0.983100000000000,0.0538000000000000];
mycmap = [0,0,1;0,0,0.749019622802734;0,0,0.498039215803146;0,0,0.374509811401367;0,0,0.250980406999588;0,0,0.188235312700272;0,0,0.125490203499794;0,0,0.107563033699989;0,0,0.0896358564496040;0,0,0.0717086866497993;0,0,0.0537815168499947;0,0,0.0358543433248997;0,0,0.0179271716624498;0,0,0;0.0156862754374743,0.0156862754374743,0;0.0313725508749485,0.0313725508749485,0;0.0470588281750679,0.0470588281750679,0;0.0627451017498970,0.0627451017498970,0;0.0784313753247261,0.0784313753247261,0;0.0941176563501358,0.0941176563501358,0;0.109803929924965,0.109803929924965,0;0.125490203499794,0.125490203499794,0;0.198366016149521,0.198366016149521,0;0.271241843700409,0.271241843700409,0;0.344117641448975,0.344117641448975,0;0.416993468999863,0.416993468999863,0;0.489869296550751,0.489869296550751,0;0.562745094299316,0.562745094299316,0;0.635620892047882,0.635620892047882,0;0.708496749401093,0.708496749401093,0;0.781372547149658,0.781372547149658,0;0.854248344898224,0.854248344898224,0;0.927124202251434,0.927124202251434,0;1,1,0;1,0.937500000000000,0;1,0.875000000000000,0;1,0.812500000000000,0;1,0.750000000000000,0;1,0.687500000000000,0;1,0.625000000000000,0;1,0.562500000000000,0;1,0.500000000000000,0;1,0.437500000000000,0;1,0.375000000000000,0;1,0.312500000000000,0;1,0.250000000000000,0;1,0.187500000000000,0;1,0.125000000000000,0;1,0.0625000000000000,0;1,0,0;0.964285731315613,0,0;0.928571403026581,0,0;0.892857134342194,0,0;0.857142865657806,0,0;0.821428596973419,0,0;0.785714268684387,0,0;0.750000000000000,0,0;0.714285731315613,0,0;0.678571403026581,0,0;0.642857134342194,0,0;0.607142865657806,0,0;0.571428596973419,0,0;0.535714268684387,0,0;0.500000000000000,0,0];
% 
% mycmap = [0,0,0.562500000000000;0,0,0.625000000000000;0,0,0.687500000000000;0,0,0.750000000000000;0,0,0.812500000000000;0,0,0.875000000000000;0,0,0.937500000000000;0,0,1;0,0,0.833333313465118;0,0,0.666666686534882;0,0,0.500000000000000;0,0,0.333333343267441;0,0,0.166666671633720;0,0,0;0.0500000007450581,0.0500000007450581,0;0.100000001490116,0.100000001490116,0;0.150000005960464,0.150000005960464,0;0.200000002980232,0.200000002980232,0;0.250000000000000,0.250000000000000,0;0.300000011920929,0.300000011920929,0;0.349999994039536,0.349999994039536,0;0.400000005960465,0.400000005960465,0;0.449999988079071,0.449999988079071,0;0.500000000000000,0.500000000000000,0;0.550000011920929,0.550000011920929,0;0.600000023841858,0.600000023841858,0;0.649999976158142,0.649999976158142,0;0.699999988079071,0.699999988079071,0;0.750000000000000,0.750000000000000,0;0.800000011920929,0.800000011920929,0;0.850000023841858,0.850000023841858,0;0.899999976158142,0.899999976158142,0;0.949999988079071,0.949999988079071,0;1,1,0;1,0.937500000000000,0;1,0.875000000000000,0;1,0.812500000000000,0;1,0.750000000000000,0;1,0.687500000000000,0;1,0.625000000000000,0;1,0.562500000000000,0;1,0.500000000000000,0;1,0.437500000000000,0;1,0.375000000000000,0;1,0.312500000000000,0;1,0.250000000000000,0;1,0.187500000000000,0;1,0.125000000000000,0;1,0.0625000000000000,0;1,0,0;0.964285731315613,0,0;0.928571403026581,0,0;0.892857134342194,0,0;0.857142865657806,0,0;0.821428596973419,0,0;0.785714268684387,0,0;0.750000000000000,0,0;0.714285731315613,0,0;0.678571403026581,0,0;0.642857134342194,0,0;0.607142865657806,0,0;0.571428596973419,0,0;0.535714268684387,0,0;0.500000000000000,0,0];
% mycmap = [0 0 0;0.125210091471672 0.125210091471672 0;0.250420182943344 0.250420182943344 0;0.357503026723862 0.357503026723862 0;0.464585840702057 0.464585840702057 0;0.571668684482574 0.571668684482574 0;0.678751528263092 0.678751528263092 0;0.785834312438965 0.785834312438965 0;0.892917156219482 0.892917156219482 0;1 1 0;1 0.946428596973419 0;1 0.892857134342194 0;1 0.839285731315613 0;1 0.785714268684387 0;1 0.732142865657806 0;1 0.678571403026581 0;1 0.625 0;1 0.571428596973419 0;1 0.517857134342194 0;1 0.46428570151329 0;1 0.41071429848671 0;1 0.357142865657806 0;1 0.303571432828903 0;1 0.25 0;1 0.21875 0;1 0.1875 0;1 0.15625 0;1 0.125 0;1 0.09375 0;1 0.0625 0;1 0.03125 0;1 0 0;0.984375 0 0;0.96875 0 0;0.953125 0 0;0.9375 0 0;0.921875 0 0;0.90625 0 0;0.890625 0 0;0.875 0 0;0.859375 0 0;0.84375 0 0;0.828125 0 0;0.8125 0 0;0.796875 0 0;0.78125 0 0;0.765625 0 0;0.75 0 0;0.734375 0 0;0.71875 0 0;0.703125 0 0;0.6875 0 0;0.671875 0 0;0.65625 0 0;0.640625 0 0;0.625 0 0;0.609375 0 0;0.59375 0 0;0.578125 0 0;0.5625 0 0;0.546875 0 0;0.53125 0 0;0.515625 0 0;0.5 0 0];
% mycmap = [0.208100000000000,0.166300000000000,0.529200000000000;0.211623809523810,0.189780952380952,0.577676190476191;0.212252380952381,0.213771428571429,0.626971428571429;0.208100000000000,0.238600000000000,0.677085714285714;0.195904761904762,0.264457142857143,0.727900000000000;0.170728571428571,0.291938095238095,0.779247619047619;0.125271428571429,0.324242857142857,0.830271428571429;0.0591333333333334,0.359833333333333,0.868333333333333;0.0116952380952381,0.387509523809524,0.881957142857143;0.00595714285714286,0.408614285714286,0.882842857142857;0.0165142857142857,0.426600000000000,0.878633333333333;0.0328523809523810,0.443042857142857,0.871957142857143;0.0498142857142857,0.458571428571429,0.864057142857143;0.0629333333333333,0.473690476190476,0.855438095238095;0.0722666666666667,0.488666666666667,0.846700000000000;0.0779428571428572,0.503985714285714,0.838371428571429;0.0793476190476190,0.520023809523810,0.831180952380952;0.0749428571428571,0.537542857142857,0.826271428571429;0.0640571428571428,0.556985714285714,0.823957142857143;0.0487714285714286,0.577223809523810,0.822828571428572;0.0343428571428572,0.596580952380952,0.819852380952381;0.0265000000000000,0.613700000000000,0.813500000000000;0.0238904761904762,0.628661904761905,0.803761904761905;0.0230904761904762,0.641785714285714,0.791266666666667;0.0227714285714286,0.653485714285714,0.776757142857143;0.0266619047619048,0.664195238095238,0.760719047619048;0.0383714285714286,0.674271428571429,0.743552380952381;0.0589714285714286,0.683757142857143,0.725385714285714;0.0843000000000000,0.692833333333333,0.706166666666667;0.113295238095238,0.701500000000000,0.685857142857143;0.145271428571429,0.709757142857143,0.664628571428572;0.180133333333333,0.717657142857143,0.642433333333333;0.217828571428571,0.725042857142857,0.619261904761905;0.258642857142857,0.731714285714286,0.595428571428571;0.302171428571429,0.737604761904762,0.571185714285714;0.348166666666667,0.742433333333333,0.547266666666667;0.395257142857143,0.745900000000000,0.524442857142857;0.442009523809524,0.748080952380952,0.503314285714286;0.487123809523809,0.749061904761905,0.483976190476191;0.530028571428571,0.749114285714286,0.466114285714286;0.570857142857143,0.748519047619048,0.449390476190476;0.609852380952381,0.747314285714286,0.433685714285714;0.647300000000000,0.745600000000000,0.418800000000000;0.683419047619048,0.743476190476191,0.404433333333333;0.718409523809524,0.741133333333333,0.390476190476190;0.752485714285714,0.738400000000000,0.376814285714286;0.785842857142857,0.735566666666667,0.363271428571429;0.818504761904762,0.732733333333333,0.349790476190476;0.850657142857143,0.729900000000000,0.336028571428571;0.882433333333333,0.727433333333333,0.321700000000000;0.913933333333333,0.725785714285714,0.306276190476191;0.944957142857143,0.726114285714286,0.288642857142857;0.973895238095238,0.731395238095238,0.266647619047619;0.993771428571429,0.745457142857143,0.240347619047619;0.999042857142857,0.765314285714286,0.216414285714286;0.995533333333333,0.786057142857143,0.196652380952381;0.988000000000000,0.806600000000000,0.179366666666667;0.978857142857143,0.827142857142857,0.163314285714286;0.969700000000000,0.848138095238095,0.147452380952381;0.962585714285714,0.870514285714286,0.130900000000000;0.958871428571429,0.894900000000000,0.113242857142857;0.959823809523810,0.921833333333333,0.0948380952380953;0.966100000000000,0.951442857142857,0.0755333333333333;0.976300000000000,0.983100000000000,0.0538000000000000];
% mycmap = [1,1,1;1,0.784313738346100,0.745098054409027;1,0.745098054409027,0.635294139385223;1,0.718750000000000,0.625000000000000;1,0.695312500000000,0.593750000000000;1,0.671875000000000,0.562500000000000;1,0.648437500000000,0.531250000000000;1,0.625000000000000,0.500000000000000;1,0.601562500000000,0.468750000000000;1,0.578125000000000,0.437500000000000;1,0.554687500000000,0.406250000000000;1,0.531250000000000,0.375000000000000;1,0.507812500000000,0.343750000000000;1,0.484375000000000,0.312500000000000;1,0.460937500000000,0.281250000000000;1,0.437500000000000,0.250000000000000;1,0.414062500000000,0.218750000000000;1,0.390625000000000,0.187500000000000;1,0.367187500000000,0.156250000000000;1,0.343750000000000,0.125000000000000;1,0.320312500000000,0.0937500000000000;1,0.296875000000000,0.0625000000000000;1,0.273437500000000,0.0312500000000000;1,0.250000000000000,0;1,0.218750000000000,0;1,0.187500000000000,0;1,0.156250000000000,0;1,0.125000000000000,0;1,0.0937500000000000,0;1,0.0625000000000000,0;1,0.0312500000000000,0;1,0,0;0.984375000000000,0,0;0.968750000000000,0,0;0.953125000000000,0,0;0.937500000000000,0,0;0.921875000000000,0,0;0.906250000000000,0,0;0.890625000000000,0,0;0.875000000000000,0,0;0.859375000000000,0,0;0.843750000000000,0,0;0.828125000000000,0,0;0.812500000000000,0,0;0.796875000000000,0,0;0.781250000000000,0,0;0.765625000000000,0,0;0.750000000000000,0,0;0.734375000000000,0,0;0.718750000000000,0,0;0.703125000000000,0,0;0.687500000000000,0,0;0.671875000000000,0,0;0.656250000000000,0,0;0.640625000000000,0,0;0.625000000000000,0,0;0.609375000000000,0,0;0.593750000000000,0,0;0.578125000000000,0,0;0.562500000000000,0,0;0.546875000000000,0,0;0.531250000000000,0,0;0.515625000000000,0,0;0.500000000000000,0,0];
% mycmap = [0.149019613862038,0.149019613862038,0.149019613862038;0.171307191252708,0.145116716623306,0.145116716623306;0.193594783544540,0.141213819384575,0.141213819384575;0.215882360935211,0.137310922145844,0.137310922145844;0.238169938325882,0.133408039808273,0.133408039808273;0.260457515716553,0.129505142569542,0.129505142569542;0.282745122909546,0.125602245330811,0.125602245330811;0.305032700300217,0.121699348092079,0.121699348092079;0.327320277690887,0.117796458303928,0.117796458303928;0.349607855081558,0.113893561065197,0.113893561065197;0.371895432472229,0.109990663826466,0.109990663826466;0.394183009862900,0.106087774038315,0.106087774038315;0.416470587253571,0.102184876799583,0.102184876799583;0.438758194446564,0.0982819795608521,0.0982819795608521;0.461045771837235,0.0943790897727013,0.0943790897727013;0.483333349227905,0.0904761925339699,0.0904761925339699;0.523076951503754,0.0835164859890938,0.0835164859890938;0.562820553779602,0.0765567794442177,0.0765567794442177;0.602564096450806,0.0695970728993416,0.0695970728993416;0.642307698726654,0.0626373663544655,0.0626373663544655;0.682051301002502,0.0556776560842991,0.0556776560842991;0.721794903278351,0.0487179495394230,0.0487179495394230;0.761538445949554,0.0417582429945469,0.0417582429945469;0.801282048225403,0.0347985364496708,0.0347985364496708;0.841025650501251,0.0278388280421495,0.0278388280421495;0.880769252777100,0.0208791214972734,0.0208791214972734;0.920512795448303,0.0139194140210748,0.0139194140210748;0.960256397724152,0.00695970701053739,0.00695970701053739;1,0,0;1,0.0500000007450581,0;1,0.100000001490116,0;1,0.150000005960464,0;1,0.200000002980232,0;1,0.250000000000000,0;1,0.300000011920929,0;1,0.349999994039536,0;1,0.400000005960465,0;1,0.449999988079071,0;1,0.500000000000000,0;1,0.550000011920929,0;1,0.600000023841858,0;1,0.649999976158142,0;1,0.699999988079071,0;1,0.750000000000000,0;1,0.800000011920929,0;1,0.850000023841858,0;1,0.899999976158142,0;1,0.949999988079071,0;1,1,0;0.990196108818054,0.990196108818054,0.0850980430841446;0.980392158031464,0.980392158031464,0.170196086168289;0.970588207244873,0.970588207244873,0.255294114351273;0.960784316062927,0.960784316062927,0.340392172336578;0.950980424880981,0.950980424880981,0.425490200519562;0.941176474094391,0.941176474094391,0.510588228702545;0.931372523307800,0.931372523307800,0.595686256885529;0.921568632125855,0.921568632125855,0.680784344673157;0.911764740943909,0.911764740943909,0.765882372856140;0.901960790157318,0.901960790157318,0.850980401039124;0.911372542381287,0.891764700412750,0.850980401039124;0.920784294605255,0.881568610668182,0.850980401039124;0.930196106433868,0.871372580528259,0.850980401039124;0.939607858657837,0.861176490783691,0.850980401039124;0.949019610881805,0.850980401039124,0.850980401039124];
%%ax = gca;
% mymap = colormap(ax);
% save('MyColormap','mymap')

set(gcf,'Colormap',mycmap);
axis xy;
% xlim([0.5 data_length + 0.5]);
interval = times(2) - times(1);
k = 1/interval;
set(gca,'LineWidth',3,'FontSize',10,'TickDir','out');
% set(gca,'xTick',1:10:data_length,'xlim',[0 data_length]);
% set(gca,'xTickLabel',-20:10:40,'xlim',[0 data_length]);
set(gca,'xTick',1:1*k:data_length,'xlim',[0 data_length]);
set(gca,'xTickLabel',times(1):1:times(end));
% set(gca,'xTick',[]);
% xlabel('Time (s)','FontSize',10,'FontWeight','Bold');
% ylabel('GC6 Trial #','FontSize',10,'FontWeight','Bold');





